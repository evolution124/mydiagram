<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36 Edg/131.0.0.0" version="25.0.3">
  <diagram name="Page-1" id="yETsX5YmY6TTT-2X_jpd">
    <mxGraphModel dx="8643" dy="9291" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-127" value="&lt;font style=&quot;font-size: 64px;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 64px;&quot;&gt;&amp;nbsp; &amp;nbsp; KERNEL_INIT&lt;/font&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;align=left;movable=0;resizable=0;rotatable=0;deletable=0;editable=0;locked=1;connectable=0;" vertex="1" parent="1">
          <mxGeometry x="-2760" y="-6443" width="1990" height="3840" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-73" value="&lt;font style=&quot;font-size: 64px;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 64px;&quot;&gt;&amp;nbsp; &amp;nbsp; KERNEL_DRV_INIT&lt;/font&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;align=left;movable=0;resizable=0;rotatable=0;deletable=0;editable=0;locked=1;connectable=0;" vertex="1" parent="1">
          <mxGeometry x="-5800" y="-6443" width="2870" height="3840" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-2" value="&lt;font style=&quot;font-size: 64px;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 64px;&quot;&gt;&amp;nbsp; &amp;nbsp; KERNEL_CONSTRUCT&lt;/font&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;align=left;movable=0;resizable=0;rotatable=0;deletable=0;editable=0;locked=1;connectable=0;" vertex="1" parent="1">
          <mxGeometry x="-130" y="-6443" width="3310" height="3840" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-1" value="gc_hal_kernel_command.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="950" y="-6390" width="770" height="830" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-2" value="&lt;b&gt;gckCOMMAND_Construct(Kernel, FeType, *Command)&lt;/b&gt;" style="text;strokeColor=#36393d;fillColor=#eeeeee;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-1" vertex="1">
          <mxGeometry y="26" width="770" height="26" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-3" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" parent="f4m65Yiiwl_Fc4j-fUvb-1" vertex="1">
          <mxGeometry y="52" width="770" height="8" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-4" value="&lt;b&gt;gckOS_Allocate&lt;/b&gt;(os, sizeof(_gckCOMMAND), &amp;amp;pointer)&amp;nbsp;&amp;nbsp;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//vmalloc 或者 kmalloc&lt;/span&gt;&lt;div&gt;command = pointer&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;gckOS_ZeroMemory(command, ...)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//memset&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;command-&amp;gt;object.type = gcvOBJ_COMMAND, kernel = kernel, os =os&lt;br&gt;command-&amp;gt;feType = Fetype&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//查询command-&amp;gt;alignment = 8 bytes&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;gckHARDWARE_QueryCommandBuffer&lt;/b&gt;(hw, gcvENGINE_RENDER, &amp;amp;command-&amp;gt;alignment, NULL,NULL)&lt;br&gt;&lt;br&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//create mutex semaphre&lt;/span&gt;&lt;br&gt;command-&amp;gt;mutexQueue, mutexContext, mutexContexSeq, powerSemaphore, &lt;b&gt;atomCommit&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//获取OS pageSize&lt;/span&gt;&lt;br&gt;&lt;b&gt;gckOS_GetPageSize&lt;/b&gt;(os, &amp;amp;pageSize)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//获取PID&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;gckOS_GetProcesID&lt;/b&gt;(&amp;amp;command-&amp;gt;kernelProcessID)&amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//getpid()&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//设置默认 pipe 0&lt;br&gt;&lt;/span&gt;command-&amp;gt;pipeSelecte = gcvPIPE_INVALID&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//预先分配 command queue:&amp;nbsp; 2个queue&lt;/span&gt;&lt;/div&gt;&lt;div&gt;for(i=0; i &amp;lt; &lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;gcdCOMMAND_QUEUE&lt;/span&gt;; ++i) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; pool = gcvPOOL_DEFAULT&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; size = pageSize&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; videoMem = NULL&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; allocFlag = 0 // gcvALLOC_FLAG_CACHEABLE&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;//为command buffer 分配 显存&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 229, 153);&quot;&gt;&lt;b&gt;gckKERNEL_AllocateVideoMemory&lt;/b&gt;(Kernel, 64, gcvVIDMEM_TYPE_COMMAND, allocFlag, &amp;amp;size, &amp;amp;pool, &amp;amp;videoMem)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; command-&amp;gt;queue[i].videoMem = videoMem&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; command-&amp;gt;queue[i].pool = pool&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;//为GPU LOCK&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 229, 153);&quot;&gt;&lt;b&gt;gckVIDMEM_NODE_Lock&lt;/b&gt;(Kernel, videoMem, &amp;amp;command-&amp;gt;queues[i].address)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;//为CPU LOCK&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 229, 153);&quot;&gt;&lt;b&gt;gckVIDMEM_LockCPU&lt;/b&gt;(Kernel, videoMem, false, false, &amp;amp;command-&amp;gt;queues[i].logical)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;gckOS_CreateSignal&lt;/b&gt;(os, false, &amp;amp;command-&amp;gt;queues[i].signal)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;gckOS_Signal&lt;/b&gt;(os, command-&amp;gt;queues[i].signal, true)&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;//分配fence, fence同样分配为LOCK CPU&amp;amp;GPU的显存(8个字节)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;gckFENCE_Create&lt;/b&gt;(os,Kernel, &amp;amp;command-&amp;gt;fence)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;command-&amp;gt;index = -1,&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;logical = null,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;newQueue = false&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if (FeType == gcvHW_FE_MULTI_CHANNEL) { ... }&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;command-&amp;gt;running = false, idle = true, &lt;b&gt;commitStamp = 1 &lt;/b&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;//stamp 从1开始&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;*Command = command&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-1" vertex="1">
          <mxGeometry y="60" width="770" height="770" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-5" value="gc_hal_kernel.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-70" y="-4890" width="510" height="604" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-6" value="&lt;b&gt;gckKERNEL_Construct(Os, Core, ChipID, Context, Device, SharedDB, *Kernel)&lt;/b&gt;" style="text;strokeColor=#36393d;fillColor=#eeeeee;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-5" vertex="1">
          <mxGeometry y="26" width="510" height="26" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-7" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" parent="f4m65Yiiwl_Fc4j-fUvb-5" vertex="1">
          <mxGeometry y="52" width="510" height="8" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-10" value="&lt;b&gt;gckOS_Allocate&lt;/b&gt;(...) //分配KERNEL struct 内存" style="text;strokeColor=default;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;strokeWidth=2;dashed=1;" vertex="1" parent="f4m65Yiiwl_Fc4j-fUvb-5">
          <mxGeometry y="60" width="510" height="80" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-14" value="&lt;b&gt;gckHARDWARE_Construct&lt;/b&gt;(Os, kernel, &amp;amp;kernel-&amp;gt;hardware)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="f4m65Yiiwl_Fc4j-fUvb-5">
          <mxGeometry y="140" width="510" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-18" value="if (kernel-&amp;gt;sharedPageTable) {&lt;br&gt;&amp;nbsp; &amp;nbsp; gckDEVICE_GetMMU(..., &amp;amp;kernel-&amp;gt;mmu)&lt;br&gt;&amp;nbsp; &amp;nbsp; if (!kernel-&amp;gt;mmu) {&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 153, 153);&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;gckMMU_Construct&lt;/b&gt;(kernel, &amp;amp;kernel-&amp;gt;mmu)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 153, 153);&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;gckDEVICE_SetMMU&lt;/b&gt;(Device, kernel-&amp;gt;hardware-&amp;gt;type, kernel-&amp;gt;mmu)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;br&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 153, 153);&quot;&gt;&lt;b&gt;_QuerySRAM&lt;/b&gt;(kernel, kernel-&amp;gt;device)&lt;/span&gt;&lt;/div&gt;" style="text;strokeColor=default;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;dashed=1;strokeWidth=2;" vertex="1" parent="f4m65Yiiwl_Fc4j-fUvb-5">
          <mxGeometry y="166" width="510" height="144" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-24" value="+ method(type): type" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="f4m65Yiiwl_Fc4j-fUvb-5">
          <mxGeometry y="310" width="510" height="26" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-9" value="&lt;b&gt;gckCOMMAND_Construct&lt;/b&gt;(kernel, feType, &amp;amp;kernel-&amp;gt;command)" style="text;strokeColor=default;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;dashed=1;strokeWidth=2;" parent="f4m65Yiiwl_Fc4j-fUvb-5" vertex="1">
          <mxGeometry y="336" width="510" height="26" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-10" value="&lt;b&gt;gckEVENT_Construct&lt;/b&gt;(kernel, kernel-&amp;gt;asyncCommand, &amp;amp;kernel-&amp;gt;asyncEvent)" style="text;strokeColor=default;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;dashed=1;strokeWidth=2;" parent="f4m65Yiiwl_Fc4j-fUvb-5" vertex="1">
          <mxGeometry y="362" width="510" height="26" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-12" value="&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;//设置MMU 相关&lt;/span&gt;&lt;/div&gt;&lt;b&gt;gckHARDWARE_PostConstruct&lt;/b&gt;(kernel-&amp;gt;hardware)" style="text;strokeColor=default;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;dashed=1;strokeWidth=2;" parent="f4m65Yiiwl_Fc4j-fUvb-5" vertex="1">
          <mxGeometry y="388" width="510" height="46" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-13" value="&lt;b&gt;gckHARDWARE_InitializeHardware&lt;/b&gt;(kernel-&amp;gt;hardware)" style="text;strokeColor=default;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;dashed=1;strokeWidth=2;" parent="f4m65Yiiwl_Fc4j-fUvb-5" vertex="1">
          <mxGeometry y="434" width="510" height="26" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-14" value="if (kernel-&amp;gt;command) &lt;b&gt;gckCOMMAND_Start&lt;/b&gt;(kernel-&amp;gt;command)" style="text;strokeColor=default;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;dashed=1;strokeWidth=2;" parent="f4m65Yiiwl_Fc4j-fUvb-5" vertex="1">
          <mxGeometry y="460" width="510" height="26" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-15" value="&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;//和profiler 相关的设置&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;kernel-&amp;gt;profiler.profilerEnable = false&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;....&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;gckOS_CreateTimer(..., &amp;amp;kernel-&amp;gt;monitorTimer)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;gckOS_StartTimer(... kernel-&amp;gt;monitorTimer, 100)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;if (kernel-&amp;gt;processPageTable) { ..}&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="text;strokeColor=default;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;dashed=1;strokeWidth=2;" parent="f4m65Yiiwl_Fc4j-fUvb-5" vertex="1">
          <mxGeometry y="486" width="510" height="118" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-16" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;entryX=0;entryY=0;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="f4m65Yiiwl_Fc4j-fUvb-9" target="f4m65Yiiwl_Fc4j-fUvb-1" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="580" y="-4893" as="sourcePoint" />
            <mxPoint x="710" y="-5110" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-17" value="gc_hal_kernel_hardware.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="950" y="-5490" width="430" height="230" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-18" value="&lt;span style=&quot;font-weight: 700; text-align: center;&quot;&gt;gckHARDWARE_PostConstruct(Hardware)&lt;/span&gt;" style="text;strokeColor=#36393d;fillColor=#eeeeee;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-17" vertex="1">
          <mxGeometry y="26" width="430" height="26" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-19" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" parent="f4m65Yiiwl_Fc4j-fUvb-17" vertex="1">
          <mxGeometry y="52" width="430" height="8" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-20" value="if (Hardware-&amp;gt;options.enableMMU) {&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 153, 153);&quot;&gt;_InitPageTableArray(Hardware)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;//此处有两个execution 一个是MMU 一个是FLUSH&lt;/span&gt;&lt;/div&gt;&lt;div&gt;for (i =0; i&amp;lt;gcvFUNCTION_EXECUTION_NUM; i++) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; gckFUNCTION_Validate(&amp;amp;Hardware-&amp;gt;functions[i], &amp;amp;funcValid)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (funcValid) gckFUNCTION_Init(&amp;amp;Hardware-&amp;gt;functions[i])&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-17" vertex="1">
          <mxGeometry y="60" width="430" height="170" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-21" value="gc_hal_kernel_hardware.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1530" y="-5490" width="420" height="210" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-22" value="&lt;b&gt;_FuncInit_MMU(gcsFUNCTION_EXECUTION_PTR Execution)&lt;/b&gt;" style="text;strokeColor=#b85450;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-21" vertex="1">
          <mxGeometry y="26" width="420" height="26" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-23" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" parent="f4m65Yiiwl_Fc4j-fUvb-21" vertex="1">
          <mxGeometry y="52" width="420" height="8" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-24" value="f&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-21" vertex="1">
          <mxGeometry y="60" width="420" height="150" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-25" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;entryX=0;entryY=0;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="f4m65Yiiwl_Fc4j-fUvb-20" target="f4m65Yiiwl_Fc4j-fUvb-21" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="720" y="-5541" as="sourcePoint" />
            <mxPoint x="980" y="-6110" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-26" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;entryX=0;entryY=0;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="f4m65Yiiwl_Fc4j-fUvb-12" target="f4m65Yiiwl_Fc4j-fUvb-17" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="580" y="-4301" as="sourcePoint" />
            <mxPoint x="840" y="-4870" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-27" value="gc_hal_kernel_hardware.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="950" y="-5160" width="670" height="1220" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-28" value="&lt;b&gt;gckHARDWARE_InitializeHardware&lt;/b&gt;(gckHARDARE Hardware)" style="text;strokeColor=#36393d;fillColor=#eeeeee;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-27" vertex="1">
          <mxGeometry y="26" width="670" height="26" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-29" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" parent="f4m65Yiiwl_Fc4j-fUvb-27" vertex="1">
          <mxGeometry y="52" width="670" height="8" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-30" value="gckOS_ReadRegisterEx(AQ_HI_CLOCK_CONTROL_Address)&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;// Disable isolate GPU bit&lt;/span&gt;&lt;/div&gt;&lt;div&gt;gckOS_WriteRegisterEx(AQ_HI_CLOCK_CONTROL_Address, ISOLATE_GPU=0)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;// 读回&lt;/span&gt;&lt;/div&gt;&lt;div&gt;gckOS_ReadRegisterEx(AQ_HI_CLOCK_CONTROL_Address, ..)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;// Enable debug&lt;/span&gt;&lt;/div&gt;&lt;div&gt;gckOS_WriteRegisterEx(AQ_HI_CLOCK_CONTROL_Address, DISABLE_DEBUG_REGISTER = 0)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;//如果 security 支持并且 hw-&amp;gt;options.secureMode=gcvSECURE_IN_NORMAL&lt;/span&gt;&lt;/div&gt;&lt;div&gt;gckOS_WriteRegisterEx(GCREG_HI_AHB_CONTROL_Address, DEBUG_MODE=1)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//Reset Memory counters&lt;/span&gt;&lt;/div&gt;&lt;div&gt;gckOS_WriteRegisterEx(GC_RESET_MEM_COUNTERS_Address, ~0)&lt;/div&gt;&lt;div&gt;gckOS_WriteRegisterEx(GC_RESET_MEM_COUNTERS_Address, 0)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;data |= GCREG_AXI_AHB_CONFIG, AWCACHE, 0x3&lt;/div&gt;&lt;div&gt;data |= GCREG_AXI_AHB_CONFIG, AWCACHE_OVERRIDE_SHARED, 0x3&lt;/div&gt;&lt;div&gt;gckOS_WriteRegisterEx(GCREG_AXI_AHB_CONFIG_Address, data)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//Enable clock gating&lt;/span&gt;&lt;/div&gt;&lt;div&gt;gckOS_ReadRegisterEx(hw-&amp;gt;powerBaseAddress + GC_MODULE_POWER_CONTROLS_Address, &amp;amp;data)&lt;/div&gt;&lt;div&gt;data = GC_MODULE_POWER_CONTROLS, ENABLE_MODULE_CLOCK_GATING 1&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;gckOS_WriteRegisterEx(hw-&amp;gt;powerBaseAddress + GC_MODULE_POWER_CONTROLS_Address, data)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 229, 153);&quot;&gt;//Initialize FE&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 153, 153);&quot;&gt;&lt;b style=&quot;&quot;&gt;gckWLFE_Initialize&lt;/b&gt;(hw, hw-&amp;gt;wlFE)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//no gckASYNC_FE_Initialize(hw, hw-&amp;gt;asyncFE)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//没有配置 regPMC&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//no AHBDEC400&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//no AXI_FE&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 153, 153);&quot;&gt;&lt;b&gt;gckHARDWARE_SetMMU&lt;/b&gt;(hw, hw-&amp;gt;kernel-&amp;gt;mmu)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//maxOutstandingReads == 0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if(gcvFEATURE_NEW_GPIPE &amp;amp;&amp;amp; !gcvFEATURE_GPIPE_CLOCK_GATE_FIX) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; if (regPMC==0)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; gckOS_ReadRegisterEx(hw-&amp;gt;powerBaseAddress + GC_MODULE_POWER_MODULE_CONTROL_Address)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; regPMC |= GC_MODULE_POWER_MODULE_CONTROL DISABLE_MODULE_CLOCK_GATING_GPIPE 1&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//Disable RA HZ clock gating&lt;/div&gt;&lt;div&gt;regPMC |= GC_MODULE_POWER_MODULE_CONTROL DISABLE_MODULE_CLOCK_GATING_RA_HZ 1&lt;/div&gt;&lt;div&gt;//Disable RA EZ clock gating&lt;/div&gt;&lt;div&gt;regPMC |= GC_MODULE_POWER_MODULE_CONTROL DISABLE_MODULE_CLOCK_GATING_RA_EZ 1&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//中间还有很多硬件型号对比去做power clock 相关的设置&lt;/div&gt;&lt;div&gt;...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;gckOS_WriteRegisterEx(hw-&amp;gt;powerBaseAddress + GC_MODULE_POWER_MODULE_CONTROL_Address, regPMC)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if(hw-&amp;gt;identity.chipRevision&amp;gt;0x5420 &amp;amp;&amp;amp; gcvFEATURE_PIP_3D) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; //Disable internal DFS&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; data = GC_PULSE_EATER ENABLE_AUTO_PULSE_SH 0&lt;br&gt;&amp;nbsp; &amp;nbsp; data |= GC_PULSE_EATER DISABLE_AUTO_PULSE 1&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;gckOS_WriteRegisterEx(GC_PULSE_EATER_Address, data)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if(gcvFEATURE_NN_ENGINE &amp;amp;&amp;amp; (!gcvFEATURE_HI_REORDER_FIX || hw-&amp;gt;kernel-&amp;gt;device-&amp;gt;extSRAMSize[0]=0) &amp;amp;&amp;amp;&lt;br&gt;&amp;nbsp; hw-&amp;gt;featureDatabase-&amp;gt;HI_DEFAULT_ENABLE_REORDER_FIX) {&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; data = GCREG_CONTROL2 DISABLE_AXI_READ_REORDER 1&lt;br&gt;&amp;nbsp; &amp;nbsp; gckOS_WriteRegisterEx(GCREG_CONTROL2_Address, data)&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 229, 153);&quot;&gt;//配置AXI policy&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;_ConfigurePolicyID&lt;/b&gt;(hw)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 229, 153);&quot;&gt;//通过command 控制NN&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;gckHARDWARE_PowerControlClusters&lt;/b&gt;(hw, hw-&amp;gt;options.configNNPowerControl, true)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;gckOS_WriteRegisterEx(AQ_INTR_ENBL_Address, 0xFFFFFFFF)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-27" vertex="1">
          <mxGeometry y="60" width="670" height="1160" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-31" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;entryX=0;entryY=0;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="f4m65Yiiwl_Fc4j-fUvb-13" target="f4m65Yiiwl_Fc4j-fUvb-27" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="450" y="-4693" as="sourcePoint" />
            <mxPoint x="880" y="-4640" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-32" value="gc_hal_kernel_hardware.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1740" y="-4580" width="430" height="114" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-33" value="&lt;b&gt;gckHARDWARE_SetMMU(hw, gckMMU mmu)&lt;/b&gt;&lt;div&gt;&lt;b&gt;设置页表baseAddress&lt;/b&gt;&lt;/div&gt;" style="text;strokeColor=#36393d;fillColor=#eeeeee;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-32" vertex="1">
          <mxGeometry y="26" width="430" height="54" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-34" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" parent="f4m65Yiiwl_Fc4j-fUvb-32" vertex="1">
          <mxGeometry y="80" width="430" height="8" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-35" value="+ method(type): type" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-32" vertex="1">
          <mxGeometry y="88" width="430" height="26" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-36" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;entryX=0;entryY=0;entryDx=0;entryDy=0;exitX=1.002;exitY=0.446;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="f4m65Yiiwl_Fc4j-fUvb-30" target="f4m65Yiiwl_Fc4j-fUvb-32" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="1780" y="-4380" as="sourcePoint" />
            <mxPoint x="2210" y="-4033" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-37" value="gc_hal_kernel_hardware.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="950" y="-3800" width="300" height="120" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-38" value="&lt;span style=&quot;font-weight: 700; text-align: center;&quot;&gt;gckCOMMAND_Start(gckCOMMAND Command)&lt;/span&gt;" style="text;strokeColor=#36393d;fillColor=#eeeeee;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-37" vertex="1">
          <mxGeometry y="26" width="300" height="26" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-39" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" parent="f4m65Yiiwl_Fc4j-fUvb-37" vertex="1">
          <mxGeometry y="52" width="300" height="8" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-40" value="if (Command-&amp;gt;feType == gcvHW_FE_WAIT_LINK)&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;_StartWaitLinkFE&lt;/b&gt;(Command)&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-37" vertex="1">
          <mxGeometry y="60" width="300" height="60" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-41" value="gc_hal_kernel_hardware.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1350" y="-3710" width="740" height="530" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-42" value="&lt;b&gt;_StartWaitLinkFE(gckCOMMAND Command)&lt;/b&gt;" style="text;strokeColor=#36393d;fillColor=#eeeeee;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-41" vertex="1">
          <mxGeometry y="26" width="740" height="26" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-43" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" parent="f4m65Yiiwl_Fc4j-fUvb-41" vertex="1">
          <mxGeometry y="52" width="740" height="8" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-44" value="hardware = Command-&amp;gt;kernel-&amp;gt;hardware&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//查询 WAIT/LINK 序列的大小&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;gckWLFE_WaitLink&lt;/b&gt;(hw, NULL, INVALID_ADDRESS, Command-&amp;gt;offset, &amp;amp;waitLinkBytes, NULL,NULL)&amp;nbsp;&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;// waitLinkBytes =32&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//此处 Command-&amp;gt;logical == NULL&lt;/span&gt;&lt;/div&gt;&lt;div&gt;if (Command-&amp;gt;pageSize - Command-&amp;gt;offset &amp;lt; waitLinkBytes) || Command-&amp;gt;logical == NULL) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(151, 208, 119);&quot;&gt;//创建一个新的Command queue&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;_NewQueue&lt;/b&gt;(Command, true)&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;logical = Command-&amp;gt;logical + Command-&amp;gt;offset&lt;/div&gt;&lt;div&gt;address = Command-&amp;gt;address + Command-&amp;gt;offset&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-41" vertex="1">
          <mxGeometry y="60" width="740" height="210" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-45" value="&lt;div&gt;&lt;b&gt;gckWLFE_WaitLink&lt;/b&gt;(hw, logical, address, 0, &amp;amp;waitLinkBytes, &amp;amp;waitOffset, &amp;amp;Command-&amp;gt;waitPos.size)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-41" vertex="1">
          <mxGeometry y="270" width="740" height="26" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-46" value="&lt;span style=&quot;background-color: rgb(0, 204, 0);&quot;&gt;//更新 wait command 地址&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;Command-&amp;gt;waitPos.videoMem = Command-&amp;gt;videoMem&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;Command-&amp;gt;waitPos.offset = Command-&amp;gt;offset + waitOffset&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;Command-&amp;gt;waitPos.logical = logical + waitOffset&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;gckVIDMEM_NODE_CleanCache&lt;/b&gt;(..., Command-&amp;gt;offset, logical, waitLinkBytes)&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-41" vertex="1">
          <mxGeometry y="296" width="740" height="104" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-47" value="&lt;span style=&quot;background-color: rgb(0, 204, 0);&quot;&gt;//调整 offset&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;Command-&amp;gt;offset += waitLinkBytes&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;Command-&amp;gt;newQueue = false&lt;/span&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-41" vertex="1">
          <mxGeometry y="400" width="740" height="60" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-48" value="&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;&lt;b&gt;gckWLFE_Execute&lt;/b&gt;(hw, address, waitLinkBytes)&lt;br&gt;&lt;/span&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(151, 208, 119);&quot;&gt;// Command queue 已经运行&lt;/span&gt;&lt;/div&gt;&lt;div&gt;Command-&amp;gt;running = true&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-41" vertex="1">
          <mxGeometry y="460" width="740" height="70" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-49" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;entryX=0;entryY=0;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="f4m65Yiiwl_Fc4j-fUvb-14" target="f4m65Yiiwl_Fc4j-fUvb-37" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="450" y="-4657" as="sourcePoint" />
            <mxPoint x="960" y="-5150" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-50" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;" parent="1" source="f4m65Yiiwl_Fc4j-fUvb-40" target="f4m65Yiiwl_Fc4j-fUvb-41" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="660" y="-3880" as="sourcePoint" />
            <mxPoint x="1290" y="-3360" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-51" value="gc_hal_kernel_command.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2230" y="-4100" width="690" height="470" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-52" value="&lt;b&gt;_NewQueue(gckCOMMAND Command, gctBOOL Stall)&lt;br&gt;Stalled, 硬件是否已经Stall&lt;/b&gt;" style="text;strokeColor=#36393d;fillColor=#eeeeee;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-51" vertex="1">
          <mxGeometry y="26" width="690" height="54" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-53" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" parent="f4m65Yiiwl_Fc4j-fUvb-51" vertex="1">
          <mxGeometry y="80" width="690" height="8" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-54" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//切换到下一个command buffer&lt;/span&gt;&lt;/div&gt;currentIndex = Command-&amp;gt;index&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // currentIndex = -1&lt;div&gt;newIndex = (currentIndex + 1) % gcdCOMMAND_QUEUES&amp;nbsp; &amp;nbsp;// newIndex = 0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 153, 153);&quot;&gt;//等待新的QUEUE 可用&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;gckOS_WaitSignal&lt;/b&gt;(Command-&amp;gt;os, Command-&amp;gt;queues[newIndex].signal, false, kernel-&amp;gt;timeOut)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//用新的 command queue 更新 gckCOMMAND&lt;/div&gt;&lt;div&gt;Command-&amp;gt;index = newIndex&lt;/div&gt;&lt;div&gt;Command-&amp;gt;newQueue = true&lt;/div&gt;&lt;div&gt;Command-&amp;gt;videoMem = Command-&amp;gt;queues[newIndex].videoMem&lt;/div&gt;&lt;div&gt;Command-&amp;gt;logical = Command-&amp;gt;queues[newIndex].logical&lt;/div&gt;&lt;div&gt;Command-&amp;gt;address = Command-&amp;gt;queues[newIndex].&lt;span style=&quot;background-color: initial;&quot;&gt;address&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;Command-&amp;gt;pool = Command-&amp;gt;queues[newIndex].pool&lt;/div&gt;&lt;div&gt;Command-&amp;gt;offset = 0&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if (currentIndex != -1) {&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 153, 153);&quot;&gt;&amp;nbsp; &amp;nbsp;if (Stalled) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 153, 153);&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;gckOS_Signal(Command-&amp;gt;os, Command-&amp;gt;queues[currentIndex].signal, true)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 153, 153);&quot;&gt;&amp;nbsp; &amp;nbsp;} else {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 153, 153);&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;gckEVENT_Signal(Command-&amp;gt;kernel-&amp;gt;eventObj, Command-&amp;gt;queues[currentIndex].signal, gcvKERNEL_COMMAND)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 153, 153);&quot;&gt;&amp;nbsp; &amp;nbsp;}&lt;/span&gt;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-51" vertex="1">
          <mxGeometry y="88" width="690" height="382" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-55" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;entryX=0;entryY=0;entryDx=0;entryDy=0;" parent="1" target="f4m65Yiiwl_Fc4j-fUvb-51" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="2090" y="-3570" as="sourcePoint" />
            <mxPoint x="2290" y="-3740.91" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-56" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeWidth=3;" parent="1" vertex="1">
          <mxGeometry x="2275" y="-3450" width="775" height="80" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-57" value="offset&amp;nbsp;&lt;br&gt;0" style="rounded=0;whiteSpace=wrap;html=1;strokeWidth=3;" parent="1" vertex="1">
          <mxGeometry x="2230" y="-3450" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-58" value="Wait" style="rounded=0;whiteSpace=wrap;html=1;strokeWidth=3;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" parent="1" vertex="1">
          <mxGeometry x="2310" y="-3450" width="90" height="80" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-59" value="Link" style="rounded=0;whiteSpace=wrap;html=1;strokeWidth=3;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" parent="1" vertex="1">
          <mxGeometry x="2400" y="-3450" width="90" height="80" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-60" value="添加Wait Link" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;" parent="1" source="f4m65Yiiwl_Fc4j-fUvb-45" target="f4m65Yiiwl_Fc4j-fUvb-57" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="1160" y="-3490" as="sourcePoint" />
            <mxPoint x="1260" y="-3490" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-61" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;strokeWidth=5;fillColor=#60a917;strokeColor=#2D7600;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2445" y="-3450" as="sourcePoint" />
            <mxPoint x="2310" y="-3450" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2445" y="-3500" />
              <mxPoint x="2310" y="-3500" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-62" value="gc_hal_kernel_hardware_waitlink_fe.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2230" y="-3200" width="650" height="450" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-63" value="&lt;b&gt;gckWLFE_Execute(Hardware, gctADDRESS Address, gctUINT32 Bytes)&lt;/b&gt;&lt;div&gt;用初始cmd, 让硬件的cmd processor开始运行&lt;/div&gt;" style="text;strokeColor=#36393d;fillColor=#eeeeee;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-62" vertex="1">
          <mxGeometry y="26" width="650" height="44" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-64" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" parent="f4m65Yiiwl_Fc4j-fUvb-62" vertex="1">
          <mxGeometry y="70" width="650" height="8" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-65" value="&lt;div&gt;eventEnable = 0xFFFFFFFF&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//使能所有的event&lt;/span&gt;&lt;div&gt;&lt;b&gt;gckOS_WriteRegisterEx&lt;/b&gt;(AQ_INTR_ENBL_Address, eventEnable)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;//graphicsLargeVA&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;gckOS_WriteRegisterEx&lt;/b&gt;(AQ_CMD_BUFFER_ADDR_HI_Address, Address&amp;gt;&amp;gt;32)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;b&gt;gckOS_WriteRegisterEx&lt;/b&gt;(AQ_CMD_BUFFER_ADDR_Address, address)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;//设置 control register, 设置Command 区域的大小&lt;/span&gt;&lt;/div&gt;&lt;div&gt;control = (AQ_CMD_BUFFER_CTRL ENABLE) | (AQ_CMD_BUFFER_CTRL PREFETCH (&lt;b&gt;Bytes&lt;/b&gt;+7)&amp;gt;&amp;gt;3&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//保证 写command buffer 和 AHB reg 已经完成&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;b style=&quot;background-color: rgb(255, 229, 153);&quot;&gt;gckOS_MemoryBarrier&lt;/b&gt;(...)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;switch(hw-&amp;gt;options.secureMode)&lt;/div&gt;&lt;div&gt;case gcvSECURE_NODE: ...;&lt;/div&gt;&lt;div&gt;case gcvSECURE_IN_NORMAL:&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;b&gt;gckOS_WriteRegisterEx&lt;/b&gt;(GCREG_CMD_BUFFER_AHB_CTRL_Address, control)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;//递增 executionCount&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;hw-&amp;gt;executionCount++&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;//2&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;//记录最近的execution address&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;hw-&amp;gt;lastExecuteAddress = Address&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="f4m65Yiiwl_Fc4j-fUvb-62" vertex="1">
          <mxGeometry y="78" width="650" height="372" as="geometry" />
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-66" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;" parent="1" source="f4m65Yiiwl_Fc4j-fUvb-48" target="f4m65Yiiwl_Fc4j-fUvb-62" edge="1">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="2100" y="-3417" as="sourcePoint" />
            <mxPoint x="2240" y="-3440" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-67" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=1;entryDx=0;entryDy=0;" parent="1" source="f4m65Yiiwl_Fc4j-fUvb-47" target="f4m65Yiiwl_Fc4j-fUvb-59" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2190" y="-3260" as="sourcePoint" />
            <mxPoint x="2240" y="-3310" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2490" y="-3280" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-68" value="Command.offset" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="f4m65Yiiwl_Fc4j-fUvb-67" vertex="1" connectable="0">
          <mxGeometry x="-0.2061" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-69" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=1;entryDx=0;entryDy=0;" parent="1" source="f4m65Yiiwl_Fc4j-fUvb-46" target="f4m65Yiiwl_Fc4j-fUvb-58" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2100" y="-3270" as="sourcePoint" />
            <mxPoint x="2500" y="-3360" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2140" y="-3360" />
              <mxPoint x="2140" y="-3330" />
              <mxPoint x="2310" y="-3330" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="f4m65Yiiwl_Fc4j-fUvb-70" value="Command.waitPos.logical" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="f4m65Yiiwl_Fc4j-fUvb-69" vertex="1" connectable="0">
          <mxGeometry x="-0.2061" y="-1" relative="1" as="geometry">
            <mxPoint x="35" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-25" value="gc_hal_kernel.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-2540" y="-4476" width="510" height="194" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-26" value="&lt;b&gt;gckDEVICE_AddCore(Device, Core, ChipID, Context, *Kernel)&lt;/b&gt;" style="text;strokeColor=#666666;fillColor=#f5f5f5;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;fontColor=#333333;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-25">
          <mxGeometry y="26" width="510" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-27" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-25">
          <mxGeometry y="52" width="510" height="8" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-29" value="&lt;b&gt;gckKERNEL_Construct&lt;/b&gt;(os, Core, ChipID, Context, Device, Device-&amp;gt;database, Kernel)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-25">
          <mxGeometry y="60" width="510" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-30" value="Device-&amp;gt;kernels[Core] = kernel&lt;br&gt;Device-&amp;gt;database = kernel-&amp;gt;db&lt;br&gt;Device-&amp;gt;coreNum ++" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-25">
          <mxGeometry y="86" width="510" height="58" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-106" value="// 选择默认 HW type:&amp;nbsp; &amp;nbsp;3D &amp;gt; 2D &amp;gt; VG&lt;br&gt;Device-&amp;gt;defaultHwType = ..." style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-25">
          <mxGeometry y="144" width="510" height="50" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-32" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;entryX=0;entryY=0;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="GQCZ_1Nqt_RRfZDzMszY-29" target="f4m65Yiiwl_Fc4j-fUvb-5">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="450" y="-4469" as="sourcePoint" />
            <mxPoint x="960" y="-5480" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-33" value="gc_hal_kernel_driver.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-5710" y="-4282" width="400" height="240" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-34" value="&lt;b&gt;viv_dev_probe(platform_device *pdev)&lt;/b&gt;" style="text;strokeColor=#666666;fillColor=#f5f5f5;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;fontColor=#333333;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-33">
          <mxGeometry y="26" width="400" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-35" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-33">
          <mxGeometry y="52" width="400" height="8" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-36" value="_InitModuleParam(...)&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if (platform-&amp;gt;ops-&amp;gt;&lt;b&gt;dmaInit&lt;/b&gt;) { platform-&amp;gt;ops-&amp;gt;&lt;b&gt;dmaInit&lt;/b&gt;(platform))&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if (platform-&amp;gt;ops-&amp;gt;&lt;b&gt;adjustParam&lt;/b&gt;) { platform-&amp;gt;ops-&amp;gt;&lt;b&gt;adjustParam&lt;/b&gt;() }&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;_SyncModuleParam&lt;/b&gt;(...)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;drv_init&lt;/b&gt;()&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;platform_set_drvdata&lt;/b&gt;(pdev, galDevice)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-33">
          <mxGeometry y="60" width="400" height="180" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-37" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="GQCZ_1Nqt_RRfZDzMszY-36" target="GQCZ_1Nqt_RRfZDzMszY-38">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="-2970" y="-5853" as="sourcePoint" />
            <mxPoint x="-4410" y="-6092" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-38" value="gc_hal_kernel_driver.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-5220" y="-4282" width="420" height="250" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-39" value="&lt;b&gt;drv_init()&lt;/b&gt;" style="text;strokeColor=#666666;fillColor=#f5f5f5;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;fontColor=#333333;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-38">
          <mxGeometry y="26" width="420" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-40" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-38">
          <mxGeometry y="52" width="420" height="8" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-41" value="&lt;b&gt;gckGALDEVICE_Construct&lt;/b&gt;(platform, &amp;amp;platform-&amp;gt;params, &amp;amp;device)&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-38">
          <mxGeometry y="60" width="420" height="30" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-46" value="&lt;b&gt;gckGALDEVICE_Start&lt;/b&gt;(device)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-38">
          <mxGeometry y="90" width="420" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-45" value="&lt;b&gt;galDevice &lt;/b&gt;= device&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;for (dev_idx = 0; dev_idx &amp;lt; device-&amp;gt;args.devCount; dev_idx++) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (type == 1)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; viv_misc_device_node_create(dev_idx)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; else&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; viv_char_device_node_create(dev_idx)&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-38">
          <mxGeometry y="116" width="420" height="134" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-47" value="gc_hal_kernel_device.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-4680" y="-6268" width="680" height="2280" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-48" value="&lt;b&gt;gckGALDEVICE_Construct(platform, *Args, *Device)&lt;/b&gt;" style="text;strokeColor=#666666;fillColor=#f5f5f5;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;fontColor=#333333;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-47">
          <mxGeometry y="26" width="680" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-49" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-47">
          <mxGeometry y="52" width="680" height="8" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-50" value="&lt;div&gt;&lt;b&gt;gal_device = kmalloc(_gckGALDEVICE, ...)&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;isrPolling = Args-&amp;gt;isrPoll&lt;/b&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-47">
          <mxGeometry y="60" width="680" height="60" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-51" value="&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;&lt;b&gt;gckOS_Construct(&lt;/b&gt;gal_device, &amp;amp;gal_device-&amp;gt;os&lt;b&gt;)&lt;/b&gt;&lt;/span&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-47">
          <mxGeometry y="120" width="680" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-52" value="&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;//配置寄存器地址空间&lt;/span&gt;&lt;/div&gt;&lt;div&gt;for (devIndex = 0; devIndex &amp;lt; &lt;b&gt;gal_device-&amp;gt;args.devCount&lt;/b&gt;; devIndex++) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;&lt;b&gt;gckDEVICE_Construct&lt;/b&gt;(os, &amp;amp;gal_device-&amp;gt;devices[devIndex])&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; device-&amp;gt;&lt;b&gt;vidMemIndex&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; = Args-&amp;gt;devMemIDs[devIndex]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;-&amp;gt;&lt;b&gt;configCoreCount&amp;nbsp;&amp;nbsp;&lt;/b&gt; = Args-&amp;gt;devCoreCounts[devIndex]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;&lt;b&gt;processPageTable &lt;/b&gt;= gal_device-&amp;gt;args.devCount &amp;gt; 1 ? false, true&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;&lt;b&gt;lockLargeVA&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;= Args-&amp;gt;lockLargeVA&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; for (i=0; i &amp;lt; &lt;b&gt;device-&amp;gt;configCoreCount&lt;/b&gt;; i++) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; device-&amp;gt;&lt;b&gt;irqLines[i]&lt;/b&gt; = Args-&amp;gt;irqs[globalIndex]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; -&amp;gt;&lt;b&gt;requestedRegisterMemBases/Sizes&lt;/b&gt;[i] = Args-&amp;gt;registerBases/Sizes[globalIndex]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; -&amp;gt;&lt;b&gt;registerBasesMapped&lt;/b&gt;[i]&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;= Args-&amp;gt;registerBasesMapped[globalIndex]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; globalIndex++&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; for (i=0; i&amp;lt; &lt;b&gt;gcvCORE_COUNT&lt;/b&gt;; i++) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; physical = device-&amp;gt;&lt;b&gt;requestedRegisterMemBases&lt;/b&gt;[i]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //设置寄存器 memory region&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (physical) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (device-&amp;gt;&lt;b&gt;registerBasesMapped&lt;/b&gt;[i]) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ... //如果已经map, 直接设置&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } else {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;request_mem_region&lt;/b&gt;(physical, device-&amp;gt;requestedRegisterMemSizes[i]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;device-&amp;gt;&lt;b&gt;registerBases&lt;/b&gt;[i] = &lt;b&gt;ioremap&lt;/b&gt;/&lt;b&gt;_nocache&lt;/b&gt;(physical, device-&amp;gt;requestedRegisterMemSizes[i])&lt;/span&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; device-&amp;gt;&lt;b&gt;registerSizes&lt;/b&gt;[i]&amp;nbsp; &amp;nbsp; = device-&amp;gt;requestedRegisterMemSizes[i]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;_QueryDeviceFeaturesFor3D&lt;/b&gt;(device)&lt;/div&gt;&lt;div&gt;} //devIndx&lt;br&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-47">
          <mxGeometry y="146" width="680" height="494" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-60" value="for (i=0; i &amp;lt; &lt;b&gt;gcdSYSTEM_RESERVE_COUNT&lt;/b&gt;; i++) { &lt;b&gt;_SetupContiguousVidMem&lt;/b&gt;(gal_device, i, Args)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-47">
          <mxGeometry y="640" width="680" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-61" value="&lt;span style=&quot;background-color: rgb(255, 229, 153);&quot;&gt;//设置外部 SRAM base address&lt;/span&gt;&lt;div&gt;for (i=0; i &amp;lt; &lt;b&gt;gcvSRAM_EXT_COUNT&lt;/b&gt;; i++) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; gal_device-&amp;gt;extSRAMBases/Sizes[i] = Args-&amp;gt;&lt;b&gt;extSRAMBases/Sizes&lt;/b&gt;[i]&lt;br&gt;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-47">
          <mxGeometry y="666" width="680" height="74" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-65" value="&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 229, 153);&quot;&gt;// 设置GAL device 本地内存&lt;/span&gt;&lt;/div&gt;for (i=0; i &amp;lt; &lt;b&gt;gcdLOCAL_MEMORY_COUNT&lt;/b&gt;; i++) {&lt;br&gt;&amp;nbsp; &amp;nbsp; gal_device-&amp;gt;externalBase/Size[i] = Args-&amp;gt;externalBase/Size[i]&lt;br&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;exclusiveBase/Size[i] = Args-&amp;gt;exclusiveBase/Size[i]&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (gal_device-&amp;gt;externalSize[i] &amp;gt;0) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; status =&amp;nbsp;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;&lt;b&gt;gckVIDMEM_Construct&lt;/b&gt;(os, -&amp;gt;&lt;b&gt;externalBase&lt;/b&gt;[i], &lt;b&gt;externalSize&lt;/b&gt;[i], 64, 0, &lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;amp;gal_device-&amp;gt;&lt;b&gt;externalVidMem&lt;/b&gt;[i])&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (ERROR(status)) gal_device-&amp;gt;&lt;b&gt;externalSize&lt;/b&gt;[i] = &lt;b&gt;0&lt;/b&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; else&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;&lt;b&gt;gckOS_RequestReservedMemory&lt;/b&gt;(os, -&amp;gt;externalBase[i], -&amp;gt;externalSize[i], name// gcExtMem%d, true,&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;amp;gal_device-&amp;gt;&lt;b&gt;externalPhysical&lt;/b&gt;[i])&lt;/span&gt;&lt;br&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; gal_device-&amp;gt;&lt;b&gt;externalVidMem&lt;/b&gt;[i]-&amp;gt;physical = gal_device-&amp;gt;&lt;b&gt;externalPhysical&lt;/b&gt;[i]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (gal_device-&amp;gt;exclusiveSize[i] &amp;gt; 0) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; status = &lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;&lt;b&gt;gckVIDMEM_Construct&lt;/b&gt;(os, -&amp;gt;exclusiveBase[i], -&amp;gt;exclusiveSize[i], 64, 0,&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;amp;gal_device-&amp;gt;&lt;b&gt;exclusiveVidMem&lt;/b&gt;[i])&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if(ERROR(status) gal_device-&amp;gt;exclusiveSize[i] = 0&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; else&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;&lt;b&gt;gckOS_RequestReservedMemory&lt;/b&gt;(os, -&amp;gt;exclusiveBase[i], -&amp;gt;exclusiveSize[i], name//gcExcMem%d, true,&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;amp;gal_device-&amp;gt;&lt;b&gt;exclusivePhysical&lt;/b&gt;[i])&lt;br&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; allocator = gal_device-&amp;gt;exclusivePhysical[i]-&amp;gt;allocator&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; gal_device-&amp;gt;exclusiveVidMem[i]-&amp;gt;physical = gal_device-&amp;gt;&lt;b&gt;exclusivePhysical&lt;/b&gt;[i]&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;gal_device-&amp;gt;exclusiveVidMem[i]-&amp;gt;capability |= allocator-&amp;gt;&lt;b&gt;capability&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;} //&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-47">
          <mxGeometry y="740" width="680" height="470" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-62" value="&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//之前的代码初始化了memory, 当前需要从gal_device复制memory信息到device, 并初始化Device&lt;/span&gt;&lt;/div&gt;for (devIndex = 0; devIndex &amp;lt; gal_device-&amp;gt;args.&lt;b&gt;devCount&lt;/b&gt;; devIndex++) {&lt;div&gt;&amp;nbsp; &amp;nbsp; device = gal_device-&amp;gt;devices[devIndex]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;// database 是共享的&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (devIndex) device-&amp;gt;database = gal_device-&amp;gt;devices[0]-&amp;gt;database&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; device-&amp;gt;externalBase/Size = gal_device-&amp;gt;externalBase/Size[&lt;b&gt;device-&amp;gt;vidMemIndex&lt;/b&gt;]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;externalPhysical&amp;nbsp; &amp;nbsp;=&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;externalPhysical&lt;span style=&quot;background-color: initial;&quot;&gt;[&lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;device-&amp;gt;vidMemIndex&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;externalVidMem&amp;nbsp; &amp;nbsp;=&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;externalVidMem&lt;span style=&quot;background-color: initial;&quot;&gt;[&lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;device-&amp;gt;vidMemIndex&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;]&lt;br&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; device-&amp;gt;exclusiveBase/Size = gal_device-&amp;gt;exclusiveBase/Size&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;[&lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;device-&amp;gt;vidMemIndex&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;]&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;exclusivePhysical&amp;nbsp; &amp;nbsp;=&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;exclusivePhysical&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;[&lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;device-&amp;gt;vidMemIndex&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;]&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;exclusiveVidMem&amp;nbsp; &amp;nbsp;=&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;exclusiveVidMem&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;[&lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;device-&amp;gt;vidMemIndex&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 229, 153);&quot;&gt;sysReserveBits = Args-&amp;gt;devSysMemIDs[devIndex]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; for (i=0; i &amp;lt; &lt;b&gt;gcdSYSTEM_RESERVE_COUNT&lt;/b&gt;; i++) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (sysReserveBits * (1&amp;lt;&amp;lt;i) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; device-&amp;gt;&lt;b&gt;contiguousBases/Sizes&lt;/b&gt;[idx] = gal_device-&amp;gt;contiguousBases/Sizes[i]&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; -&amp;gt;contiguousPhysicals[idx]&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;= gal_device-&amp;gt;contiguousPhysicals[i]&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; -&amp;gt;contiguousVidMems[idx]&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;= gal_device-&amp;gt;contiguousVidMems[i]&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; idx++&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; device-&amp;gt;&lt;b&gt;lowContiguousBase/Size&lt;/b&gt; = gal_device-&amp;gt;lowContiguousBase/Size&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; for (i=0; i &amp;lt;= &lt;b&gt;gcvSRAM_EXT_COUNT&lt;/b&gt;; i++) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (Args-&amp;gt;devSRAMIDs[idx] &amp;amp; (1&amp;lt;&amp;lt;i) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; device-&amp;gt;&lt;b&gt;extSRAMBases/Sizes&lt;/b&gt;[idx] = gal_device-&amp;gt;extSRAMBases/Sizes[i]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; for (i=&lt;b&gt;gcvCORE_MAJOR&lt;/b&gt;; i&amp;lt;=&lt;b&gt;gcvCORE_3D_MAX&lt;/b&gt;; i++) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (device-&amp;gt;irqLines[i] != -1 || BITTEST(isrPolling, i) !=0 {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;&lt;b style=&quot;&quot;&gt;gckDEVICE_AddCore&lt;/b&gt;(device, i, Args-&amp;gt;chipIDs[i], gal_device, &amp;amp;device&amp;gt;kernels[i])&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;gckHARDWARE_SetFastClear&lt;/b&gt;(&lt;br&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;gckHARDWARE_EnablePowerManagment&lt;/b&gt;(&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;gckHARDWARE_SetMinFscaleValue&lt;/b&gt;(&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } else {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; device-&amp;gt;kernel = NULL&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;} //&lt;span style=&quot;background-color: initial;&quot;&gt;devCount&lt;/span&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-47">
          <mxGeometry y="1210" width="680" height="740" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-67" value="&lt;b&gt;_SetupExternalSRAMVidMem&lt;/b&gt;(gal_device, Args)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-47">
          <mxGeometry y="1950" width="680" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-74" value="&lt;div&gt;&lt;span style=&quot;background-color: rgb(230, 230, 230);&quot;&gt;//gcmPTR_TO_NAME 就是在pointer database 里面记录并返回 database table id&lt;/span&gt;&lt;/div&gt;if (gal_device-&amp;gt;internalPhysical)&amp;nbsp; gal_device-&amp;gt;internalPhysical = &lt;b&gt;gcmPTR_TO_NAME&lt;/b&gt;(gal_device-&amp;gt;internalPhysical)&amp;nbsp;&lt;br&gt;if(&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;lowContiguousPhysical)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; =&amp;nbsp;&lt;b&gt;gcmPTR_TO_NAME&lt;/b&gt;(gal_device-&amp;gt;lowContiguousPhysical)&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;//gcdSYSTEM_RESERVE_COUNT&lt;/span&gt;&lt;/div&gt;&lt;div&gt;if(&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;contiguousPhysicals[i])&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; =&amp;nbsp;&lt;b&gt;gcmPTR_TO_NAME&lt;/b&gt;(gal_device-&amp;gt;contiguousPhysicals[i])&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;//gcdLOCAL_MEMORY_COUNT&lt;/span&gt;&lt;/div&gt;&lt;div&gt;if(&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;externalPhysicals[i])&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; =&amp;nbsp;&lt;b&gt;gcmPTR_TO_NAME&lt;/b&gt;(gal_device-&amp;gt;externalPhysicals[i])&lt;/div&gt;&lt;div&gt;if(&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&amp;gt;exclusivePhysicals[i])&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; =&amp;nbsp;&lt;b&gt;gcmPTR_TO_NAME&lt;/b&gt;(gal_device-&amp;gt;exclusivePhysicals[i])&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//gal_device-&amp;gt;args.devCount&lt;/div&gt;&lt;div&gt;for (devIndex = 0; devIndex &amp;lt; gal_device-&amp;gt;args.devCount; devIndex++) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; device = gal_device-&amp;gt;devices[devIndex]&lt;br&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;br&gt;&amp;nbsp; &amp;nbsp; device-&amp;gt;externalPhysName = gal_device-&amp;gt;externalPhysName[device-&amp;gt;vidMemIndex]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;device-&amp;gt;exclusivePhysName = gal_device-&amp;gt;exclusivePhysName[device-&amp;gt;vidMemIndex]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; sysReserveBits = Args-&amp;gt;devSysMemIDs[devIndex]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; for (i=0; index =0; i&amp;lt; gcdSYSTEM_RESERVE_COUNT; i++) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;if (sysReserveBits &amp;amp; (1&amp;lt;&amp;lt;i) { device-&amp;gt;contiguousPhysNames[index] = gal_device-&amp;gt;contiguousPhysNames[i]; index++)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;div&gt;}&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-47">
          <mxGeometry y="1976" width="680" height="304" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-53" value="DEFINE" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=default;" vertex="1" parent="1">
          <mxGeometry x="-4270" y="-6990" width="480" height="216" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-55" value="" style="line;strokeWidth=1;fillColor=default;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-53">
          <mxGeometry y="26" width="480" height="8" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-56" value="&lt;b&gt;gcdDEVICE_COUNT&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 卡的数量" style="text;strokeColor=none;fillColor=default;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-53">
          <mxGeometry y="34" width="480" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-64" value="&lt;b&gt;gcvCORE_COUNT&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ？？？" style="text;strokeColor=none;fillColor=default;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-53">
          <mxGeometry y="60" width="480" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-63" value="&lt;b&gt;gcvSRAM_EXT_COUNT&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;？？？" style="text;strokeColor=none;fillColor=default;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-53">
          <mxGeometry y="86" width="480" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-66" value="&lt;b&gt;gcdLOCAL_MEMORY_COUNT&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ？？？" style="text;strokeColor=none;fillColor=default;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-53">
          <mxGeometry y="112" width="480" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-69" value="&lt;b&gt;gcdSYSTEM_RESERVE_COUNT&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ？？？" style="text;strokeColor=none;fillColor=default;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-53">
          <mxGeometry y="138" width="480" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-68" value="&lt;b&gt;gcvCORE_MAJOR&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ？？？" style="text;strokeColor=none;fillColor=default;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-53">
          <mxGeometry y="164" width="480" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-70" value="&lt;b&gt;gcvCORE_3D_MAX&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;？？？" style="text;strokeColor=none;fillColor=default;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-53">
          <mxGeometry y="190" width="480" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-71" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;entryX=0;entryY=0;entryDx=0;entryDy=0;exitX=0.998;exitY=0.798;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="GQCZ_1Nqt_RRfZDzMszY-62" target="GQCZ_1Nqt_RRfZDzMszY-25">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="-1420" y="-4881" as="sourcePoint" />
            <mxPoint x="-1290" y="-4880" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-72" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="GQCZ_1Nqt_RRfZDzMszY-41" target="GQCZ_1Nqt_RRfZDzMszY-47">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="-4910" y="-6412" as="sourcePoint" />
            <mxPoint x="-4810" y="-6348" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-75" value="Address Spaces" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=default;" vertex="1" parent="1">
          <mxGeometry x="-3080" y="-7012" width="420" height="260" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-76" value="Device" style="text;strokeColor=none;fillColor=default;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-75">
          <mxGeometry y="26" width="420" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-77" value="" style="line;strokeWidth=1;fillColor=default;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-75">
          <mxGeometry y="52" width="420" height="8" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-78" value="RegisterBases / Sizes" style="text;strokeColor=none;fillColor=default;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-75">
          <mxGeometry y="60" width="420" height="40" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-79" value="externalBase / Sizes" style="text;strokeColor=none;fillColor=default;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-75">
          <mxGeometry y="100" width="420" height="40" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-80" value="exclusiveBase / Sizes" style="text;strokeColor=none;fillColor=default;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-75">
          <mxGeometry y="140" width="420" height="40" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-81" value="contiguousBase /Sizes" style="text;strokeColor=none;fillColor=default;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-75">
          <mxGeometry y="180" width="420" height="40" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-104" value="extSramBase /Sizes" style="text;strokeColor=none;fillColor=default;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-75">
          <mxGeometry y="220" width="420" height="40" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-107" value="gc_hal_kernel_os.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-2540" y="-6200" width="420" height="194" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-108" value="&lt;b&gt;gckOS_Construct( Context, gckOS *Os)&lt;/b&gt;" style="text;strokeColor=#666666;fillColor=#f5f5f5;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;fontColor=#333333;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-107">
          <mxGeometry y="26" width="420" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-109" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-107">
          <mxGeometry y="52" width="420" height="8" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-112" value="&lt;div&gt;&lt;b&gt;ffff&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-107">
          <mxGeometry y="60" width="420" height="134" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-113" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;entryX=0;entryY=0;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="GQCZ_1Nqt_RRfZDzMszY-51" target="GQCZ_1Nqt_RRfZDzMszY-107">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="-3210" y="-6050" as="sourcePoint" />
            <mxPoint x="-839" y="-5600" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-114" value="gc_hal_kernel.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-2540" y="-5810" width="760" height="400" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-115" value="&lt;b&gt;gckDEVICE_Construct(gckOS Os, gckDEVICE * Device)&lt;/b&gt;" style="text;strokeColor=#666666;fillColor=#f5f5f5;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;fontColor=#333333;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-114">
          <mxGeometry y="26" width="760" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-116" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-114">
          <mxGeometry y="52" width="760" height="8" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-117" value="&lt;div&gt;&lt;b&gt;gckOS_Allocate&lt;/b&gt;(Os, ..., &amp;amp;device)&amp;nbsp; &amp;nbsp; //vmalloc/kmalloc&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-114">
          <mxGeometry y="60" width="760" height="30" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-119" value="&lt;div&gt;//初始化数据结构&lt;/div&gt;&lt;div&gt;for (i=0; i &amp;lt; &lt;b&gt;gcvCORE_COUNT&lt;/b&gt;; i++) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; device-&amp;gt;coreInfoArray[i].type = INVALID; -&amp;gt;irqLines[i] = -1;&lt;br&gt;&amp;nbsp; &amp;nbsp; for (j = 0; j &amp;lt; &lt;b&gt;gcvSRAM_INTER_COUNT&lt;/b&gt;; j++) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; device-&amp;gt;sRAMBases[i][j] = INVALID; sRAMSizes = 0; sRAMPhysFaked[i][j] = false;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-114">
          <mxGeometry y="90" width="760" height="110" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-120" value="&lt;div&gt;//初始化外部sram&lt;/div&gt;&lt;div&gt;for (i=0; i&amp;lt;gcvSRAM_EXT_COUNT; i++) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; device-&amp;gt;extSRAMGPUBaese[i] = INVALID; -&amp;gt;extSRAMBases[i] = INVALID; -&amp;gt;extSRAMSizes[i] = 0;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;device-&amp;gt;defaultHwType = INVALID&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;//初始化mutex&lt;br&gt;device-&amp;gt;stuckDumpMutex, -&amp;gt;commitMutex, -&amp;gt;powerMutex, -&amp;gt;recoveryMutex, -&amp;gt;fenceListMutex&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-114">
          <mxGeometry y="200" width="760" height="140" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-121" value="&lt;div&gt;&lt;b&gt;gcsLIST_Init&lt;/b&gt;(&amp;amp;device-&amp;gt;fenceList)&lt;br&gt;&lt;b&gt;idr_init&lt;/b&gt;(device-&amp;gt;fenceIdr)&lt;/div&gt;&lt;div&gt;spin_lock_init(&amp;amp;device-&amp;gt;fenceIdrLock)&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-114">
          <mxGeometry y="340" width="760" height="60" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-118" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;entryX=0;entryY=0;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="GQCZ_1Nqt_RRfZDzMszY-52" target="GQCZ_1Nqt_RRfZDzMszY-114">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="-3450" y="-6080" as="sourcePoint" />
            <mxPoint x="-3070" y="-6590" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-122" value="gc_hal_kernel_driver.c" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-4680" y="-3861" width="680" height="510" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-123" value="&lt;b&gt;gckGALDEVICE_Start(device)&lt;/b&gt;" style="text;strokeColor=#666666;fillColor=#f5f5f5;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;fontColor=#333333;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-122">
          <mxGeometry y="26" width="680" height="26" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-124" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-122">
          <mxGeometry y="52" width="680" height="8" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-125" value="for(devIndex = 0; devIndex &amp;lt; Device-&amp;gt;args.devCount; devIndex++) {&lt;div&gt;&amp;nbsp; &amp;nbsp; device = Device-&amp;gt;devices[devIndex];&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 255, 204);&quot;&gt;//启动kernel threads&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; for (i=0; i &amp;lt; gcvCORE_COUNT; ++i) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;_StartThread&lt;/b&gt;(device, i)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; for (i=0; i &amp;lt; gcvCORE_COUNT; i++) {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; kernel = device-&amp;gt;kernels[i]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (!kernel) continue;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (!i &amp;amp;&amp;amp; kernel-&amp;gt;processPageTable &amp;amp;&amp;amp; &lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(kernel-&amp;gt;command-&amp;gt;pool == gcvPOOL_VIRTUAL || !kernel-&amp;gt;flatMapping)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 229, 153);&quot;&gt;&lt;b&gt;gckMMU_ConstructMmuCopy&lt;/b&gt;(kernel, &amp;amp;kernel-&amp;gt;mmuCopy)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;_SetupIsr&lt;/b&gt;(device, i)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style=&quot;background-color: rgb(255, 229, 153);&quot;&gt;&lt;b&gt;gckHARDEARE_SetPowerState&lt;/b&gt;(kernel-&amp;gt;hardware, gcvPOWER_OFF_BROADCAST)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" vertex="1" parent="GQCZ_1Nqt_RRfZDzMszY-122">
          <mxGeometry y="60" width="680" height="450" as="geometry" />
        </mxCell>
        <mxCell id="GQCZ_1Nqt_RRfZDzMszY-126" value="dispatch" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="GQCZ_1Nqt_RRfZDzMszY-46" target="GQCZ_1Nqt_RRfZDzMszY-122">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="-4610" y="-4197" as="sourcePoint" />
            <mxPoint x="-4120" y="-6258" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
